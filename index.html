<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rrish - Music Teacher & Blues Improviser</title>
    <meta
      name="description"
      content="Rrish is a musician who improvises on blues and different music genres. Learn music at 
  every level and improve your improvisation skills."
    />
    
    <!-- Theme FOUC Prevention Script -->
    <script type="text/javascript">
      // Enhanced FOUC (Flash of Unstyled Content) prevention for theme system
      // This script runs immediately to apply the user's preferred theme before React loads
      (function() {
        'use strict';
        
        try {
          // Theme system constants
          const THEME_STORAGE_KEY = 'rrishmusic-theme-mode';
          const DARK_MODE_MEDIA_QUERY = '(prefers-color-scheme: dark)';
          const DEFAULT_THEME_MODE = 'system';
          
          // Theme color definitions
          const lightThemeColors = {
            primary: '#3b82f6',
            primaryHover: '#2563eb',
            primaryActive: '#1d4ed8',
            secondary: '#6b7280',
            secondaryHover: '#4b5563',
            secondaryActive: '#374151',
            background: '#ffffff',
            backgroundSecondary: '#f8fafc',
            backgroundTertiary: '#f1f5f9',
            text: '#111827',
            textSecondary: '#4b5563',
            textMuted: '#6b7280',
            border: '#e5e7eb',
            borderHover: '#d1d5db',
            divider: '#f3f4f6',
            success: '#10b981',
            warning: '#f59e0b',
            error: '#ef4444',
            info: '#3b82f6',
            accent: '#f59e0b',
            shadow: 'rgba(0, 0, 0, 0.1)',
            overlay: 'rgba(0, 0, 0, 0.5)'
          };
          
          const darkThemeColors = {
            primary: '#60a5fa',
            primaryHover: '#3b82f6',
            primaryActive: '#2563eb',
            secondary: '#9ca3af',
            secondaryHover: '#d1d5db',
            secondaryActive: '#f3f4f6',
            background: '#111827',
            backgroundSecondary: '#1f2937',
            backgroundTertiary: '#374151',
            text: '#f9fafb',
            textSecondary: '#d1d5db',
            textMuted: '#9ca3af',
            border: '#374151',
            borderHover: '#4b5563',
            divider: '#1f2937',
            success: '#34d399',
            warning: '#fbbf24',
            error: '#f87171',
            info: '#60a5fa',
            accent: '#fbbf24',
            shadow: 'rgba(0, 0, 0, 0.3)',
            overlay: 'rgba(0, 0, 0, 0.7)'
          };
          
          // Utility functions
          function getSystemTheme() {
            if (typeof window === 'undefined') return 'light';
            if (!window.matchMedia) return 'light';
            
            try {
              return window.matchMedia(DARK_MODE_MEDIA_QUERY).matches ? 'dark' : 'light';
            } catch (error) {
              return 'light';
            }
          }
          
          function getMotionPreference() {
            if (typeof window === 'undefined') return false;
            if (!window.matchMedia) return false;
            
            try {
              return window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            } catch (error) {
              return false;
            }
          }
          
          function loadThemeFromStorage() {
            try {
              const stored = localStorage.getItem(THEME_STORAGE_KEY);
              if (stored && ['light', 'dark', 'system'].includes(stored)) {
                return stored;
              }
            } catch (error) {
              // Ignore localStorage errors
            }
            return DEFAULT_THEME_MODE;
          }
          
          function resolveActiveTheme(mode) {
            if (mode === 'system') {
              return getSystemTheme();
            }
            return mode;
          }
          
          function createCSSCustomProperties(colors) {
            return {
              '--color-primary': colors.primary,
              '--color-primary-hover': colors.primaryHover,
              '--color-primary-active': colors.primaryActive,
              '--color-secondary': colors.secondary,
              '--color-secondary-hover': colors.secondaryHover,
              '--color-secondary-active': colors.secondaryActive,
              '--color-background': colors.background,
              '--color-background-secondary': colors.backgroundSecondary,
              '--color-background-tertiary': colors.backgroundTertiary,
              '--color-text': colors.text,
              '--color-text-secondary': colors.textSecondary,
              '--color-text-muted': colors.textMuted,
              '--color-border': colors.border,
              '--color-border-hover': colors.borderHover,
              '--color-divider': colors.divider,
              '--color-success': colors.success,
              '--color-warning': colors.warning,
              '--color-error': colors.error,
              '--color-info': colors.info,
              '--color-accent': colors.accent,
              '--color-shadow': colors.shadow,
              '--color-overlay': colors.overlay
            };
          }
          
          // Apply theme immediately
          function applyTheme() {
            const savedMode = loadThemeFromStorage();
            const activeTheme = resolveActiveTheme(savedMode);
            const reducedMotion = getMotionPreference();
            
            const colors = activeTheme === 'dark' ? darkThemeColors : lightThemeColors;
            const colorCustomProperties = createCSSCustomProperties(colors);
            
            const root = document.documentElement;
            
            // Set initial classes
            root.classList.add('theme-no-transition', 'theme-loading');
            if (reducedMotion) {
              root.classList.add('theme-no-transition');
            }
            
            // Apply color custom properties
            Object.entries(colorCustomProperties).forEach(function(entry) {
              root.style.setProperty(entry[0], entry[1]);
            });
            
            // Set theme class
            root.className = root.className.replace(/\btheme-light\b|\btheme-dark\b/g, '').trim();
            root.classList.add('theme-' + activeTheme);
            
            // Remove loading class after styles are applied
            setTimeout(function() {
              root.classList.remove('theme-loading');
              root.classList.add('theme-loaded');
            }, 16); // Next frame
          }
          
          // Apply theme as early as possible
          if (document.readyState === 'loading') {
            applyTheme();
          } else {
            // Document already loaded, apply immediately
            applyTheme();
          }
          
        } catch (error) {
          console.warn('[Theme FOUC Prevention] Failed to prevent FOUC:', error);
          // Apply basic light theme as fallback
          try {
            document.documentElement.classList.add('theme-light', 'theme-loaded');
          } catch (fallbackError) {
            // Silent fallback failure
          }
        }
      })();
    </script>
    
    <!-- GitHub Pages SPA routing script -->
    <script type="text/javascript">
      // Single Page Application redirect handling for GitHub Pages
      // This script processes redirects from 404.html and restores the original URL
      (function(l) {
        if (l.search[1] === '/' ) {
          try {
            var decoded = l.search.slice(1).split('&').map(function(s) { 
              return s.replace(/~and~/g, '&')
            }).join('?');
            
            // Log the redirect in development
            if (l.hostname === 'localhost' || l.hostname === '127.0.0.1') {
              console.log('[GitHub Pages SPA] Processing redirect from 404.html');
              console.log('[GitHub Pages SPA] Original search:', l.search);
              console.log('[GitHub Pages SPA] Decoded URL:', decoded);
            }
            
            // Replace the current URL with the original route
            window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + decoded + l.hash
            );
          } catch (error) {
            console.warn('[GitHub Pages SPA] Error processing redirect:', error);
            // If decoding fails, just clear the search params
            window.history.replaceState(null, null, l.pathname + l.hash);
          }
        }
      }(window.location))
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>